#!/bin/bash
# Build the pages. (No assets.)

# Include the libraries.
libPath="$(dirname "$0")/lib"
. "$libPath/all.sh" || exit 1

# Load the config.
. config || exit 1

# Handle parameters.
for parameter in $@; do
    echo $parameter

    if [ "${1:0:1}" == '-' ]; then
        case $1 in
            '--test')
                echo "Test mode turned on"
                touch "build/.test"
                doTest=1
            ;;
        esac
        shift 1
    fi
done
remaining="$1"

#rm -Rf ../intermediate
mkdir -p build
generateMasks
getDocs '' "$remaining" | prepDocs
getDocs f "$remaining" | buildDocs
getDocs l "$remaining" | buildDocs
copyAssets

wait

# TODO Do lowercase symlinks.
