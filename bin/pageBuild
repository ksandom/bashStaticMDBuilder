#!/bin/bash
# Build the pages. (No assets.)

# Load the config.
. config

# Include the libraries.
libPath="$(dirname "$0")/lib"
. "$libPath/all.sh"

# Handle parameters.
for parameter in $@; do
    echo $parameter

    if [ "${1:0:1}" == '-' ]; then
        case $1 in
            '--test')
                echo "Test mode turned on"
                touch "build/.test"
                doTest=1
            ;;
        esac
        shift 1
    fi
done
remaining="$1"

#rm -Rf ../intermediate
mkdir -p build
getDocs '' "$remaining" | prepDocs
getDocs f "$remaining" | buildDocs
getDocs l "$remaining" | buildDocs
copyAssets

# TODO Do lowercase symlinks.
